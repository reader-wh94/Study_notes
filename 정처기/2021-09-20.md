## 2021-09-20

### 8-1. 절차형 SQL 작성하기

> 프로시저

**프로시저 구성**

* 선언부(DECLARE)
  * 프로시저의 명칭, 변수와 인수 그리고 그에 대한 데이터 타입을 정의하는 부분
* 시작/종료부(BEGIN/END)
  * 프로시저의 시작과 종료를 표현하며, BEGIN,END가 쌍을 이룸
  * 다수 실행을 제어하는 기본적 단위가 되며 논리적 프로세스를 구성
* 제어부(CONTROL)
  * 기본적으로는 순차적으로 처리
  * 조건문과 반복문을 이용하여 문장을 처리
* SQL
  * DML을 주로 사용
  * 자주 사용되지 않지만 DDL 중 TRUNCATE 사용
* 예외부(EXCEPTION)
  * BEGIN ~ END 절에서 실행되는 SQL 문이 실행될 때 예외 발생 시 예외 처리 방법을 정의하는 처리부
* 실행부(TRANSACTION)
  * 트리거에서 수행된 DML 수행 내역의 DBMS의 적용 또는 취소 여부를 결정하는 처리부

<br>

> 사용자 정의함수

**사용자 정의함수 구성**

* 기본적인 사항은 프로시저와 동일하고 반환에서의 부분만 프로시저와 다르다
* 기본적인 개념 및 사용법, 문법 등은 프로시저와 동일하며, 종료 시 단일 값을 반환한다는 것이 프로시저와의 가장 큰 차이점이다.
* 선언부(DECLARE)
  * 프로시저의 명칭, 변수와 인수 그리고 그에 대한 데이터 타입을 정의하는 부분
* 시작/종료부(BEGIN/END)
  * 프로시저의 시작과 종료를 표현하는 데 필수적이며, BEGIN,END가 쌍을 이루어 추가되므로 블록으로 구성
  * 다수 실행을 제어하는 기본적 단위가 되며 논리적으로 프로세스를 구성
* 제어부(CONTROL)
  * 기본적으로는 순차적으로 처리
  * 비교 조건에 따라 블록 또는 문장을 실행
  * 조건에 따라 반복을 실행
* SQL
  * 조회 용도로 SELECT 문을 사용
  * 데이터를 조작하는 INSERT, DELETE UPDATE는 사용할 수 없음
* 예외부(EXCEPTION)
  * BEGIN ~ END 절에서 실행되는 SQL문이 실행될 때 예외 발생 시 예외 처리 방법을 정의하는 처리부
* 반환부(RETURN)
  * 호출문에 대한 함수 값을 반환

<br>

> 트리거

**트리거의 구성**

* EVENT 명령어를 통해 트리거 실행을 위한 이벤트를 인지한다는 점, 외부 변수 IN / OUT이 없다는 점은 프로시저나 사용자 정의함수와 다르다.
* 선언부(DECLARE)
  * 트리거의 명칭을 정의하는 부분
* 이벤트부(EVENT)
  * 트리거가 실행되는 타이밍, 이벤트를 명시하는 부분
* 시작/종료부(BEGIN/END)
  * 트리거의 시작과 종료를 표현하는 데 필수적이며, BEGIN/END가 쌍을 이루어 추가되므로 블록으로 구성
  * 다수 실행을 제어하는 기본적 단위가 되며 논리적 프로세스를 구성
* 제어부(CONTROL)
  * 기본적으로는 순차적으로 처리
  * 비교 조건에 따라 블록 또는 문장을 실행
  * 조건에 따라 반복 실행
* SQL
  * DML을 주로 사용하고, 자주 사용되지 않지만 DDL(TRUNCATE 등)을 사용
* 예외부(EXCEPTION)
  * BEGIN ~ END 절에서 실행되는 SQL 문이 실행될 때 예외 발생 시 예외 처리 방법을 정의하는 처리부